'''

@author: Automation
'''
import os
import unittest
from time import sleep
from appium import webdriver
from altunityrunner import AltrunUnityDriver
from workflow.Scene1Tasks import Scene1Tasks
from workflow.Scene2Tasks import Scene2Tasks


PATH = lambda p: os.path.abspath(
    os.path.join(os.path.dirname(__file__), p)
)
class BaseTest(unittest.TestCase):
    altdriver = None
    eledriver=  None
    text= None
    platform = "android" # set to iOS to change platform

    @classmethod
    def setUpClass(self):
        self.desired_caps = {}
        if (self.platform == "android"):
            self.desired_caps['platformName'] = 'Android'
            self.desired_caps['deviceName'] = 'device'
            self.desired_caps['newCommandTimeout'] = 400
            self.desired_caps['app'] = PATH('../../../match.apk')
        else: 
            self.desired_caps['platformName'] = 'iOS'
            self.desired_caps['deviceName'] = 'iPhone8'
            self.desired_caps['automationName'] = 'XCUITest'
            self.desired_caps['app'] = PATH('../../../match.ipa')

        self.driver = webdriver.Remote('http://localhost:4723/wd/hub', self.desired_caps)
        self.altdriver = AltrunUnityDriver(self.driver, self.platform)
        

    @classmethod
    def tearDownClass(self):
        self.altdriver.stop()
        self.driver.quit()
        
    def test_01(self):
        self.scene1=Scene1Tasks(self.altdriver)
        self.altdriver.wait_for_current_scene_to_be('MainMenu')
        sleep(10)
        self.scene1.checkInformation()
        self.scene1.clickPlay()
        self.altdriver.wait_for_current_scene_to_be('Map')
        sleep(5)
        self.scene2=Scene2Tasks(self.altdriver)
        self.scene2.clickLives()
        self.scene2.clickClose()
        self.scene2.clickAchivements()
        self.scene2.clickCloseRightPanel()
        self.scene2.clickSettings()
        self.scene2.clickClose()
        
        self.scene2.selectLevel('Level 1')
        self.scene2.clickPlay()

if __name__ == "__main__":
    #import sys;sys.argv = ['', 'Test.testName']
    unittest.main()